## 数据库
hammer环境提供了数据库相关接口用于连接并操作数据库。

### 连接数据库

可以通过以下方法获取一个数据库连接对象。

`Database.connect(url, username, password)`

#### 参数

| 名称       | 说明    | 类型     | 必填  |
|----------|-------|--------|-----|
| url      | 数据库地址 | String | 是   |
| username | 用户名   | String | 是   |
| password | 密码    | String | 是   |

#### 返回值
- 类型: [DataBaseConnect](#databaseconnect)
- 数据库连接对象，可用于执行增删改查操作。
- 当连接失败时，返回`null`值。

#### 示例
```
    var db = Database.connect("mysql://localhost:3306/base", "root", "123456");
    var result = db.query("SELECT * FROM `test-table` WHERE id=114514");
    print("name: " + result[0]['id']);
    db.close();
```
hammer内部通过JDBC驱动连接数据库，目前仅支持部分关系型数据库:
- MySQL
- MariaSQL

## DataBaseConnect

数据库连接对象

- [查询](#查询)
- [更新](#更新)
- [连接是否活跃](#连接是否活跃)
- [连接是否被关闭](#连接是否被关闭)
- [开启事务](#开启事务)
- [提交事务](#提交事务)
- [滚回操作](#滚回操作)

### 查询
`query(sql)`

#### 参数

| 名称  | 说明    | 类型     | 必填  |
|-----|-------|--------|-----|
| sql | SQL语句 | String | 是   |

#### 返回值
- 类型: **Array<Json<String,Object>>**
- 返回值为元素类型为键值对的数组

### 更新
`update(sql)`

用于执行增删改操作

#### 参数

| 名称  | 说明    | 类型     | 必填  |
|-----|-------|--------|-----|
| sql | SQL语句 | String | 是   |

#### 返回值
- 类型: **int**
- 返回受到影响的行数。

### 连接是否活跃
`isActive()`

检查是否保持连接
#### 返回值
- 类型: **boolean**
- 返回为true时，说明保持连接，可以操作数据库。

### 连接是否被关闭
`isClosed()`
#### 返回值
- 类型: **boolean**
- 返回为true时，无法继续操作数据库。

### 开启事务
`trans()`

默认为自动提交，即每次执行update()函数的操作都立即生效，开启事务后将暂停自动提交。

### 提交事务
`commit()`

数据库将写入事务所作的更改

### 滚回操作
`rollback()`

撤销事务所作的更改

## 关于事务

事务是数据库中一系列操作的最小逻辑单元。
在这个逻辑单元中的所有语句，要不都执行成功，要么都执行失败，不存在任何中间状态。
一旦事务执行失败，那么所有的操作都会被撤销，一旦事务执行成功，那么所有的操作结果都会被保存。